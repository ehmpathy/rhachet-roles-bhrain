# blackbox criteria: review output devexp

## usecase.1 = default output path when --output is omitted

given('a user invokes review without --output')
  when('--rules and --paths are specified but --output is omitted')
    then('the review succeeds without error')
      sothat('users can invoke review without the need to think about output paths')
    then('the review is written to .review/$branch/$isotime.output.md')
      sothat('outputs are organized by branch and time')
    then('the output path is printed to stdout')
      sothat('users know where to find their review')

  when('the .review/ directory does not exist')
    then('the .review/ directory is created automatically')
      sothat('first-time usage works without manual setup')
    then('the branch subdirectory is created automatically')
      sothat('the full path hierarchy is established')

## usecase.2 = explicit output path with absent parent directory

given('a user specifies --output with a path whose parent does not exist')
  when('--output .reviews/v1.md is specified and .reviews/ is absent')
    then('the parent directory .reviews/ is created automatically')
      sothat('users dont need to mkdir before they invoke review')
    then('the review is written to the specified path')
      sothat('explicit output paths work as expected')

  when('--output nested/deep/path/review.md is specified and nested/deep/path/ is absent')
    then('all parent directories are created recursively')
      sothat('arbitrarily nested paths work without manual setup')
    then('the review is written to the specified path')

## usecase.3 = explicit output path with present parent directory

given('a user specifies --output with a path whose parent already exists')
  when('--output .reviews/v2.md is specified and .reviews/ is present')
    then('no directory creation is attempted')
      sothat('present directory structures are respected')
    then('the review is written to the specified path')

## usecase.4 = default output path format

given('the default output path is generated')
  when('the current branch is "main"')
    then('the output path contains "main" as the branch segment')
      sothat('outputs are organized by branch name')

  when('the current branch is "feat/my-feature"')
    then('the branch segment becomes "feat.my-feature"')
      sothat('branches with slashes dont create unwanted subdirectories')

  when('the review is invoked at 2026-02-03T14:30:00Z')
    then('the isotime segment reflects the invocation time')
      sothat('multiple reviews are distinguishable by time')
    then('the isotime format is filesystem-safe')
      sothat('colons and other unsafe characters are handled')
