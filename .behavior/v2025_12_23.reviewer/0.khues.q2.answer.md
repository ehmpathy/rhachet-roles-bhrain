# q2: inject context vs auto-explore?

## tl;dr

**inject context (`--hard`) for bounded review tasks.**
**auto-explore (`--soft`) for open-ended investigation.**

---

## analysis

### the reviewer use case is bounded

the wish defines a reviewer with:
- `--rules` = known set of rule files
- `--diffs` = known set of changed files
- `--paths` = known set of target files

this is a **closed-scope task**. the inputs are fully enumerable before invocation.

---

## when to inject (`--hard`)

use `--hard` when:

| condition | rationale |
|-----------|-----------|
| scope is fully known | no discovery needed; inject what matters |
| determinism matters | guarantees exact files are reviewed |
| token budget is predictable | can failfast if over limit |
| latency matters | avoids N tool calls to open files |
| auditability matters | `input.prompt.md` shows exactly what was reviewed |

**reviewer fits all of these.**

---

## when to auto-explore (`--soft`)

use `--soft` when:

| condition | rationale |
|-----------|-----------|
| scope is open-ended | agent may need to chase imports, dependencies |
| discovery is the goal | e.g., "find security issues anywhere" |
| context would exceed limits | let agent be selective |
| interactive feedback loop | human guides what to look at next |

---

## hybrid approach

the wish already supports this via `--soft` vs `--hard` flags.

a sensible default:
- `--hard` for `--rules` (always need full rule text)
- `--hard` for `--diffs` (the primary review target)
- `--soft` for `--paths` (supplementary context, agent can open if needed)

or simpler: default to `--hard` for everything, failfast if too big.

---

## cost considerations

| mode | tool calls | tokens in prompt | predictability |
|------|------------|------------------|----------------|
| `--hard` | 0 | high (pre-loaded) | fully predictable |
| `--soft` | N (agent opens files) | low initially | unpredictable |

for automation at scale, `--hard` is preferable:
- exact cost known before invocation
- no variance from agent decisions
- reproducible runs

---

## recommendation for reviewer

```
default: --hard

rationale:
- review scope is fully specified by caller
- rules MUST be loaded (they define the review criteria)
- diffs MUST be loaded (they are the review target)
- extra paths SHOULD be loaded (supplementary context)

failfast:
- if total tokens > context limit, abort with clear message
- emit token estimate in input.args.json for transparency
```

---

## when soft makes sense

`--soft` is useful for:
1. very large diffs where selective review is needed
2. exploratory reviews ("check this area generally")
3. interactive mode where human guides focus

but for the primary use case (automated review against known rules + diffs), `--hard` wins.

---

## sources

- wish: explicit `--soft` vs `--hard` modes already designed
- vision: examples show bounded, enumerable inputs
