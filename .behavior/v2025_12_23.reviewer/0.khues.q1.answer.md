# q1: can claude-code run interactive mode with json output at exit?

## answer: no, not directly

`--output-format json` only works with non-interactive/print mode (`-p`).

however, alternatives exist:

---

## option 1: resume-based workflow

chain `-p` calls with `--resume` to simulate interactive behavior while getting JSON:

```bash
# first query
output=$(claude -p "analyze this code" --output-format json)
session_id=$(echo "$output" | jq -r '.session_id')

# continue the conversation
claude -p "now check security" --resume "$session_id" --output-format json
claude -p "generate summary" --resume "$session_id" --output-format json
```

---

## option 2: hybrid approach

run interactive mode normally, then use `--continue` with `-p` at the end:

```bash
# interactive session (no json)
claude

# after exit, get final state as json
claude -p "summarize what we did" --continue --output-format json
```

---

## option 3: agent sdk

if you need true interactive + JSON, use the Python/TypeScript Agent SDK which gives full control over the conversation loop and output format.

---

## rationale

the fundamental issue is that interactive mode is designed for human-in-the-loop workflows (REPL), while JSON output is for programmatic integration.

the `--resume` pattern bridges these use cases.

---

## sources

- Claude Code CLI Reference
- Claude Code Headless/Agent SDK Documentation
- Claude Code Interactive Mode Documentation
