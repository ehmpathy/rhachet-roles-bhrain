# blackbox criteria: init.research

## usecase.1 = initialize research directory

given('a thinker wants to research a new domain')
  when('they run `npx rhachet run --repo bhrain --role librarian --skill init.research --name {name}`')
    then('a `.research/v{isodate}.{name}/` directory is created')
      sothat('research artifacts have a dedicated, versioned location')
    then('`0.wish.md` is created with a template for the research question')
      sothat('the thinker can articulate what they want to learn')
    then('`1.probes.aim.src` is created with instructions for probe articulation')
      sothat('the thinker knows how to formulate 21+ questions and divergent paths')
    then('`2.probes.emit.src` is created with instructions for probe dispatch')
      sothat('the thinker knows how to send parallel agents to investigate')
    then('`3.probes.absorb.src` is created with instructions for comprehension')
      sothat('the thinker knows how to synthesize findings into kernels, clusters, and gaps')
    then('`4.probes.remit.src` is created with instructions for gap-fill')
      sothat('the thinker knows how to supplement with additional probes')
    then('`5.briefs.curate.src` is created with instructions for externalization')
      sothat('the thinker knows how to produce structured briefs from distillations')
    then('`.bind/{user}.{name}.flag` is created')
      sothat('the research is bound to the current branch and user')

given('the research directory already exists')
  when('they run init.research with the same name')
    then('an error is returned')
      sothat('prior research is not overwritten')

given('a thinker wants to start in a specific directory')
  when('they run init.research with `--dir {path}`')
    then('the research directory is created under `{path}/.research/`')
      sothat('research can live alongside the target codebase')

---

## usecase.2 = articulate probes (aim phase)

given('a research directory with `0.wish.md` filled in')
  when('the thinker follows `1.probes.aim.src`')
    then('they articulate 21+ questions to investigate')
      sothat('breadth of inquiry is enforced')
    then('they identify divergent paths across parallel domains')
      sothat('unexpected insights can surface from analogies')
    then('`1.probes.aim.md` is emitted with the probe definitions')
      sothat('the probes are captured as an artifact')
    then('`probes/` directory is created with individual probe files')
      sothat('each probe can be investigated independently')

---

## usecase.3 = dispatch probes (emit phase)

given('a research directory with probes defined in `probes/`')
  when('the thinker follows `2.probes.emit.src`')
    then('parallel agents fan out to investigate each probe')
      sothat('research proceeds concurrently')
    then('each agent writes findings to `probes/probe-NNN.findings.md`')
      sothat('results are captured per-probe')
    then('the thinker can pause and resume at any point')
      sothat('research can span sessions, days, or weeks')

---

## usecase.4 = synthesize findings (absorb phase)

given('a research directory with probe findings in `probes/`')
  when('the thinker follows `3.probes.absorb.src`')
    then('`distill.kernels.md` is created first, with facts, assumptions, claims, questions, opinions')
      sothat('raw findings are distilled into atomic knowledge units')
    then('`distill.clusters.md` is created second, with kernels clustered by topic and treestruct')
      sothat('knowledge is organized hierarchically with cross-links')
    then('`distill.gaps.md` is created third, with explicit, implicit, and symmetric omissions')
      sothat('what is unknown is surfaced alongside what is known')

---

## usecase.5 = fill gaps (remit phase)

given('a research directory with gaps identified in `distill.gaps.md`')
  when('the thinker follows `4.probes.remit.src`')
    then('supplemental probes are dispatched to fill detected gaps')
      sothat('omissions and contradictions are addressed')
    then('supplemental findings are added to `probes/`')
      sothat('the knowledge base grows incrementally')
    then('absorb artifacts are updated with new knowledge')
      sothat('distillations reflect the complete picture')

---

## usecase.6 = curate briefs (curate phase)

given('a research directory with distillations complete')
  when('the thinker follows `5.briefs.curate.src`')
    then('`output.briefs/{domain}/` is created with structured briefs')
      sothat('knowledge is externalized in the standard brief format')
    then('briefs follow `{code}XXX.{subtopic}._.[doctype].md` pattern')
      sothat('they integrate with librarian conventions')
    then('briefs are organized by domain and tier (101, 201, 301, 401)')
      sothat('prerequisite depth is clear')

---

## usecase.7 = resume research

given('a research directory with partial progress')
  when('the thinker returns to the directory')
    then('all prior artifacts are preserved')
      sothat('no work is lost')
    then('the thinker can continue from any phase')
      sothat('research is pausable and resumable')
    then('the `.bind/` flag indicates which branch owns the research')
      sothat('concurrent work is coordinated')
