# blueprint: openai codex

## .what

openai codex is a cloud-based coding agent that runs tasks in isolated sandbox containers, enabling parallel task execution, background processing, and integration with github workflows.

## .why

codex represents a different architectural approach than claude code: cloud-first with network isolation, parallel task model, and deep github integration. comparing these architectures reveals tradeoffs in the replic brain design space.

---

## core agentic loop

### pseudocode

```python
def run_cloud_task(task_description, repository, environment):
    # provision isolated cloud container
    container = provision_sandbox(
        repository=repository,
        environment=environment,
        network_access=False  # disabled by default
    )

    # clone repository into container
    container.clone_repo(repository)

    # run setup script if defined
    if environment.setup_script:
        container.run(environment.setup_script)

    # agentic loop within sandbox
    context = initialize_context(task_description)

    while True:
        response = llm.generate(
            messages=context,
            tools=SANDBOX_TOOLS,
            model="gpt-5-codex"
        )

        if response.has_tool_calls:
            for tool_call in response.tool_calls:
                # execute within sandbox (no external network)
                result = container.execute(tool_call)
                context.append(result)

                # run tests after code changes
                if is_code_change(tool_call):
                    test_result = container.run_tests()
                    context.append(test_result)
        else:
            # task complete
            break

    # propose changes
    return container.create_pr_proposal()
```

### key characteristics

| aspect | implementation |
|--------|----------------|
| execution environment | isolated cloud container |
| network access | disabled by default (configurable) |
| loop type | async, runs in background |
| parallelism | multiple tasks can run simultaneously |
| termination | agent decides task complete, proposes PR |

### sources

- [Codex Cloud Architecture](https://developers.openai.com/codex/cloud/) — cloud sandbox docs
- [Codex Security Guide](https://developers.openai.com/codex/security/) — isolation model

---

## context management

### strategy: full context with large windows

unlike claude code's compaction approach, codex leverages large context windows and cloud execution:

```
┌────────────────────────────────────────┐
│         CODEX CONTEXT MODEL            │
├────────────────────────────────────────┤
│  [task description]                    │
│  [repository state]                    │
│  [execution history]                   │
│  [test results]                        │
│  [full file contents as needed]        │
│                                        │
│  (no explicit compaction — session     │
│   scoped to single task completion)    │
└────────────────────────────────────────┘
```

### context characteristics

| aspect | approach |
|--------|----------|
| session length | single task (not open-ended) |
| history accumulation | full for task duration |
| compaction | not prominent; tasks are bounded |
| persistence | task artifacts saved, context ephemeral |

### sources

- [Codex CLI Features](https://developers.openai.com/codex/cli/features/) — context handling

---

## tool interface

### sandbox tools

| category | capabilities |
|----------|--------------|
| filesystem | read, write, edit files in workspace |
| execution | run commands, tests, builds |
| git | commit, branch, diff |
| github | create PRs, read issues |

### network isolation

```
┌────────────────────────────────────────┐
│           CODEX SANDBOX                │
├────────────────────────────────────────┤
│                                        │
│  [Agent]───[Filesystem]                │
│      │                                 │
│      └────[Shell Execution]            │
│      │                                 │
│      └────[Git Operations]             │
│                                        │
│  ┌─────────────────────────────────┐   │
│  │     NETWORK: BLOCKED BY DEFAULT │   │
│  │  (can be enabled by admin)      │   │
│  └─────────────────────────────────┘   │
│                                        │
└────────────────────────────────────────┘
```

### sandboxing methods

| environment | method |
|-------------|--------|
| local (cli) | seatbelt (macos), seccomp+landlock (linux) |
| cloud | isolated containers |

### sources

- [Codex Security Guide](https://developers.openai.com/codex/security/) — sandboxing details
- [Codex SDK](https://developers.openai.com/codex/sdk/) — tool interface

---

## parallel task pattern

### multi-task execution

```
┌─────────────────────────────────────────────────────┐
│                   USER REQUEST                       │
│  "Fix auth bug AND add logging to API endpoints"    │
└──────────────────────┬──────────────────────────────┘
                       │
          ┌────────────┴────────────┐
          │                         │
    ┌─────▼─────┐            ┌──────▼─────┐
    │  Task 1   │            │   Task 2   │
    │ (auth bug)│            │ (logging)  │
    │           │            │            │
    │ Container │            │ Container  │
    │     A     │            │     B      │
    └─────┬─────┘            └──────┬─────┘
          │                         │
          │    [run in parallel]    │
          │                         │
    ┌─────▼─────┐            ┌──────▼─────┐
    │   PR #1   │            │   PR #2    │
    └───────────┘            └────────────┘
```

### task lifecycle

1. task created (via chat, github, slack, etc.)
2. container provisioned with repo
3. agent executes in background
4. tests run automatically after changes
5. PR proposed when complete
6. user reviews and merges

### sources

- [Codex Cloud Architecture](https://developers.openai.com/codex/cloud/) — parallel execution

---

## reasoning strategy

### test-driven iteration

codex emphasizes running tests as the verification mechanism:

```
[Write code change]
        │
        ↓
[Run tests automatically]
        │
        ├── tests pass → continue
        │
        └── tests fail → iterate
                │
                ↓
        [Analyze failure]
                │
                ↓
        [Fix and re-run]
```

### implicit CoT/ReAct

reasoning is embedded in the agent's approach but not always explicitly visible to users.

---

## github integration

### workflow triggers

| trigger | action |
|---------|--------|
| @codex mention | create task from issue/PR |
| slack command | create task |
| chat interface | create task |
| api call | create task |

### pr proposal flow

```
[Task completes in sandbox]
         │
         ↓
[Generate diff + description]
         │
         ↓
[Propose as draft PR]
         │
         ↓
[User reviews]
         │
    ┌────┴────┐
    │         │
[merge]  [request changes]
              │
              ↓
         [new task]
```

### sources

- [Codex Cloud Architecture](https://developers.openai.com/codex/cloud/) — github integration

---

## model

### gpt-5-codex

- purpose-built for codex workloads
- optimized for code understanding and generation
- supports tool use
- available via api key or chatgpt subscription

### sources

- [Introducing Upgrades to Codex](https://openai.com/index/introducing-upgrades-to-codex/) — model details

---

## benchmark performance

| benchmark | notes |
|-----------|-------|
| SWE-bench | competitive performance |
| practical tasks | strong on isolated, test-driven tasks |
| pr proposals | high quality with context |

---

## architectural summary

```
┌────────────────────────────────────────────────────────┐
│                     OPENAI CODEX                       │
├────────────────────────────────────────────────────────┤
│  ┌──────────────────────────────────────────────────┐  │
│  │              TASK QUEUE                          │  │
│  │  [task 1] [task 2] [task 3] ... (parallel)      │  │
│  └──────────────────────────────────────────────────┘  │
│                         │                              │
│  ┌──────────────────────▼──────────────────────────┐  │
│  │          CLOUD SANDBOX (per task)               │  │
│  │  ┌────────────────────────────────────────┐     │  │
│  │  │  Repository Clone                      │     │  │
│  │  │  + Environment Setup                   │     │  │
│  │  │  + Network Isolation                   │     │  │
│  │  └────────────────────────────────────────┘     │  │
│  │                    │                             │  │
│  │  ┌─────────────────▼────────────────────────┐   │  │
│  │  │          AGENTIC LOOP                    │   │  │
│  │  │  while not done:                         │   │  │
│  │  │    response = llm.generate()             │   │  │
│  │  │    execute_tools()                       │   │  │
│  │  │    run_tests()  # automatic              │   │  │
│  │  │    iterate_if_failing()                  │   │  │
│  │  └──────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────┘  │
│                         │                              │
│  ┌──────────────────────▼──────────────────────────┐  │
│  │              PR PROPOSAL                         │  │
│  │  [diff] [description] [test results]            │  │
│  └──────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────┘
```

---

## concepts utilized

- [llm](./arc101.concept.llm.[article].md)
- [context-window](./arc104.concept.context-window.[article].md)
- [agentic-loop](./arc109.concept.agentic-loop.[article].md)
- [tool-call](./arc107.concept.tool-call.[article].md)
- [tool-result](./arc108.concept.tool-result.[article].md)
- [session](./arc120.concept.session.[article].md) (task-scoped)
- [react-pattern](./arc111.concept.react-pattern.[article].md) (implicit)

---

## key differences from claude code

| aspect | claude code | codex |
|--------|-------------|-------|
| execution | local or sdk | cloud sandbox |
| network | controlled | blocked by default |
| parallelism | subagents | multiple tasks |
| context | compaction | task-bounded |
| integration | cli + ide | github + slack + api |
| pr workflow | manual | auto-proposed |
