
# vision: route.stone.del tune

## the outcome world

### before

```
âžœ rhx route.stone.del --route .behavior/v2026_02_04.drive-spinners --stone research

ðŸª¨ run solid skill repo=bhrain/role=driver/skill=route.stone.del

no stones matched pattern
```

the user typed exactly what they meant â€” "research" â€” and got none. they had to guess the glob syntax `*.research.*` to match. then the destructive delete happened immediately with no preview. the output was a flat comma-separated wall:

```
deleted: 3.1.research.access._.v1, 3.1.research.domain._.v1, 3.1.research.domain.terms.v1, 3.1.research.patterns._.code.prod.v1, 3.1.research.patterns._.code.test.v1, 3.1.research.references._.v1, 3.1.research.templates._.v1
skipped (artifact found): 3.1.research.claims._.v1, 3.1.research.patterns._.oss.levers.v1
```

hard to scan. hard to verify before it's too late.

### after

```
âžœ rhx route.stone.del --route .behavior/v2026_02_04.drive-spinners --stone research

ðŸ¦‰ hoo needs 'em

ðŸ—¿ route.stone.del --mode plan
   â”œâ”€ pattern = *research* (from "research")
   â”œâ”€ route   = .behavior/v2026_02_04.drive-spinners
   â”œâ”€ stones
   â”‚  â”œâ”€ âœ“ 3.1.research.access._.v1 (delete)
   â”‚  â”œâ”€ âŠ˜ 3.1.research.claims._.v1 (retain, artifact found)
   â”‚  â”œâ”€ âœ“ 3.1.research.domain._.v1 (delete)
   â”‚  â”œâ”€ âœ“ 3.1.research.domain.terms.v1 (delete)
   â”‚  â”œâ”€ âœ“ 3.1.research.patterns._.code.prod.v1 (delete)
   â”‚  â”œâ”€ âœ“ 3.1.research.patterns._.code.test.v1 (delete)
   â”‚  â”œâ”€ âŠ˜ 3.1.research.patterns._.oss.levers.v1 (retain, artifact found)
   â”‚  â”œâ”€ âœ“ 3.1.research.references._.v1 (delete)
   â”‚  â””â”€ âœ“ 3.1.research.templates._.v1 (delete)
   â”œâ”€ delete = 7
   â””â”€ retain = 2 (artifact found)

rerun with --mode apply to execute
```

the user sees exactly what will happen before any file changes. they type the natural word. the output is a scannable tree. then they confirm:

```
âžœ rhx route.stone.del --route .behavior/v2026_02_04.drive-spinners --stone research --mode apply

ðŸ¦‰ hoo needs 'em

ðŸ—¿ route.stone.del --mode apply
   â”œâ”€ pattern = *research* (from "research")
   â”œâ”€ route   = .behavior/v2026_02_04.drive-spinners
   â”œâ”€ stones
   â”‚  â”œâ”€ âœ“ 3.1.research.access._.v1 (deleted)
   â”‚  â”œâ”€ âŠ˜ 3.1.research.claims._.v1 (retained, artifact found)
   â”‚  â”œâ”€ âœ“ 3.1.research.domain._.v1 (deleted)
   â”‚  â”œâ”€ âœ“ 3.1.research.domain.terms.v1 (deleted)
   â”‚  â”œâ”€ âœ“ 3.1.research.patterns._.code.prod.v1 (deleted)
   â”‚  â”œâ”€ âœ“ 3.1.research.patterns._.code.test.v1 (deleted)
   â”‚  â”œâ”€ âŠ˜ 3.1.research.patterns._.oss.levers.v1 (retained, artifact found)
   â”‚  â”œâ”€ âœ“ 3.1.research.references._.v1 (deleted)
   â”‚  â””â”€ âœ“ 3.1.research.templates._.v1 (deleted)
   â”œâ”€ deleted  = 7
   â””â”€ retained = 2 (artifact found)
```

### the aha moment

"i just typed `research` and it did exactly what i meant â€” showed me what would happen first, then i confirmed. no glob syntax to remember. no surprises."

---

## user experience

### usecase 1: prune a phase of stones

**goal**: clean up all research stones after distill is complete

```
rhx route.stone.del --route .behavior/v2026_02_05.my-feature --stone research
```

- `research` auto-expands to `*research*`
- plan mode shows which stones match, which have artifacts
- user reruns with `--mode apply` to confirm

### usecase 2: delete a specific stone

**goal**: remove exactly one stone by name

```
rhx route.stone.del --route .behavior/v2026_02_05.my-feature --stone 3.1.research.domain._.v1
```

- exact match still works â€” the pattern `*3.1.research.domain._.v1*` matches only one stone
- plan mode shows one stone, user confirms

### usecase 3: delete all stones (careful!)

**goal**: wipe a route clean

```
rhx route.stone.del --route .behavior/v2026_02_05.old-route --stone '*'
```

- user must use explicit `*` glob for "match all"
- plan mode is critical here â€” shows the full list before any file removal

### contract

**inputs**:
- `--stone <pattern>` â€” required. pattern to match stone names. auto-wrapped with `*...*` if no glob characters present
- `--route <path>` â€” required. path to route directory
- `--mode <plan|apply>` â€” optional. defaults to `plan`. controls whether to preview or execute

**outputs (plan mode)**:
- treestruct of all matched stones with intent (delete / retain)
- summary counts
- hint to rerun with `--mode apply`

**outputs (apply mode)**:
- treestruct of all matched stones with outcome (deleted / retained)
- summary counts

---

## mental model

> "it's like `terraform plan` before `terraform apply` â€” but for route stones"

users would describe it as: "i tell it what stones to target, it shows me the plan, then i say go."

terms alignment:
- user says "delete research stones" â†’ `--stone research`
- user says "show me what would happen" â†’ `--mode plan` (default)
- user says "do it" â†’ `--mode apply`

---

## evaluation

### how well does it solve the goals?

| goal | solved? | how |
|------|---------|-----|
| natural pattern match | yes | auto-wrap with `*...*` when no glob chars present |
| safe by default | yes | `--mode plan` is default; destructive only on explicit `--mode apply` |
| scannable output | yes | treestruct with per-stone status lines and summary |

### pros

- **pit of success**: destructive operation requires explicit opt-in
- **minimum surface area**: most common case (`--stone research`) requires zero glob knowledge
- **scannable**: tree output groups stones visually, easy to verify at a glance
- **terraform-familiar**: plan/apply mental model is industry standard

### cons

- **extra step**: users who know what they want must add `--mode apply` (mitigated: muscle memory forms fast, and safety outweighs speed)
- **auto-wrap ambiguity**: `--stone '*.research.*'` â€” does the auto-wrap apply? no, it detects found glob chars (`*`, `?`) and skips the wrap. clear rule: if pattern contains `*` or `?`, use as-is; otherwise wrap with `*...*`

### edgecases

| edge | behavior | pit of success? |
|------|----------|-----------------|
| `--stone research` (no globs) | auto-expands to `*research*` | yes â€” matches user intent |
| `--stone '*.research.*'` (explicit glob) | used as-is | yes â€” respects explicit intent |
| `--stone '*'` (match all) | matches all stones | yes â€” plan mode shows full list first |
| `--stone nonexistent` | expands to `*nonexistent*`, matches none | yes â€” clear "no stones matched" message |
| no `--mode` flag | defaults to `plan` | yes â€” safe by default |
| `--mode apply` without prior plan | works directly (no enforcement of plan-first) | yes â€” user opted in explicitly |

